<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.5">
<meta name="keywords" content="arquitectura de redes, telemática">
<meta name="author" content="Diego Fernández">
<title>Arquitectura de Redes Avanzadas</title>
<style>
/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

object, svg { display: inline-block; vertical-align: middle; }

.center { margin-left: auto; margin-right: auto; }

.spread { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.4; color: #111111; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #ad141e; text-decoration: underline; line-height: inherit; }
a:hover, a:focus { color: #ad141e; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.5; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Helvetica Neue", "Helvetica", Arial, sans-serif; font-weight: normal; font-style: normal; color: #111111; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #5e5e5e; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: "Andale Mono", "monotype.com", "Lucida Console", monospace; font-weight: normal; color: #222222; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.5; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: #222222; border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: inherit; color: #555555; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #555555; }

blockquote, blockquote p { line-height: 1.5; color: #6f6f6f; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #dddddd; }
table thead, table tfoot { background: whitesmoke; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #222222; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f9f9f9; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.2; }

body { -moz-osx-font-smoothing: grayscale; -webkit-font-smoothing: antialiased; tab-size: 4; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: inherit; font-style: normal !important; letter-spacing: 0; padding: 2px; background-color: #eeeeee; -webkit-border-radius: 0; border-radius: 0; line-height: inherit; word-wrap: break-word; }
*:not(pre) > code.nobreak { word-wrap: normal; }
*:not(pre) > code.nowrap { white-space: nowrap; }

pre, pre > code { line-height: 1.5; color: white; font-family: Monaco, Consolas, "Courier New", Courier, Sans-serif; font-weight: normal; }

em em { font-style: normal; }

strong strong { font-weight: normal; }

.keyseq { color: #555555; }

kbd { font-family: "Andale Mono", "monotype.com", "Lucida Console", monospace; display: inline-block; color: #222222; font-size: 0.65em; line-height: 1.45; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: 0 0.15em; padding: 0.2em 0.5em; vertical-align: middle; position: relative; top: -0.1em; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menu { color: #090909; }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

p a > code:hover { color: #151515; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: black; margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #dddddd; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #dddddd; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #dddddd; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: #555555; display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: #6f6f6f; }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: #6f6f6f; }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: black; border-bottom: 1px solid #dddddd; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#toc { border-bottom: 1px solid #dddddd; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: "Helvetica Neue", "Helvetica", Arial, sans-serif; list-style-type: none; }
#toc li { line-height: 1.3334; margin-top: 0.3334em; }
#toc a { text-decoration: none; }
#toc a:active { text-decoration: underline; }

#toctitle { color: #111111; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background-color: #f2f2f2; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #dddddd; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; margin-bottom: 0.8rem; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #dddddd; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: #222222; padding: 1.25em; }

#footer-text { color: #dddddd; line-height: 1.35; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { .sect1 { padding-bottom: 1.25em; } }
.sect1 + .sect1 { border-top: 1px solid #dddddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #111111; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #040404; }

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; }

table.tableblock > caption.title { white-space: nowrap; overflow: visible; max-width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { color: black; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: initial; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: "Helvetica Neue", "Helvetica", Arial, sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #555555; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: #111111; margin-top: 0; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #333333; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { border: 0 solid #dddddd; -webkit-border-radius: 0; border-radius: 0; word-wrap: break-word; padding: 10px; font-size: 0.8125em; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }

.literalblock.output pre { color: #333333; background-color: white; }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 10px; -webkit-border-radius: 0; border-radius: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; line-height: 1.5; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 1.25em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock blockquote p { color: #6f6f6f; font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: #111111; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.5em; margin-right: 0.5ex; text-align: right; }
.quoteblock .quoteblock { margin-left: 0; margin-right: 0; padding: 0.5em 0; border-left: 3px solid #555555; }
.quoteblock .quoteblock blockquote { padding: 0 0 0 0.75em; }
.quoteblock .quoteblock blockquote:before { display: none; }

.verseblock { margin: 0 1em 1.25em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: #6f6f6f; font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: inherit; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.025em; color: #555555; }

.quoteblock.abstract { margin: 0 0 1.25em 0; display: block; }
.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p { text-align: left; word-spacing: 0; }
.quoteblock.abstract blockquote:before, .quoteblock.abstract blockquote p:first-of-type:before { display: none; }

table.tableblock { max-width: 100%; border-collapse: separate; }
table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #dddddd; }

table.grid-all th.tableblock, table.grid-all td.tableblock { border-width: 0 1px 1px 0; }

table.grid-all tfoot > tr > th.tableblock, table.grid-all tfoot > tr > td.tableblock { border-width: 1px 1px 0 0; }

table.grid-cols th.tableblock, table.grid-cols td.tableblock { border-width: 0 1px 0 0; }

table.grid-all * > tr > .tableblock:last-child, table.grid-cols * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-rows th.tableblock, table.grid-rows td.tableblock { border-width: 0 0 1px 0; }

table.grid-all tbody > tr:last-child > th.tableblock, table.grid-all tbody > tr:last-child > td.tableblock, table.grid-all thead:last-child > tr > th.tableblock, table.grid-rows tbody > tr:last-child > th.tableblock, table.grid-rows tbody > tr:last-child > td.tableblock, table.grid-rows thead:last-child > tr > th.tableblock { border-bottom-width: 0; }

table.grid-rows tfoot > tr > th.tableblock, table.grid-rows tfoot > tr > td.tableblock { border-width: 1px 0 0 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot { border-width: 1px 0; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.2; background: whitesmoke; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: #222222; font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }

ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }

ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-square-o:first-child, ul.checklist li > p:first-child > .fa-check-square-o:first-child { width: 1em; font-size: 0.85em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { width: 1em; position: relative; top: 1px; }

ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1, td.hdlist2 { vertical-align: top; padding: 0 0.625em; }

td.hdlist1 { font-weight: bold; padding-bottom: 1.25em; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0 0.75em; line-height: 1; }
.colist > table tr > td:first-of-type img { max-width: initial; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; display: inline-block; }
a.image object { pointer-events: none; }

sup.footnote, sup.footnoteref { font-size: 0.875em; position: static; vertical-align: super; }
sup.footnote a, sup.footnoteref a { text-decoration: none; }
sup.footnote a:active, sup.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -0.25em 0 0.75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em 0 0.225em; line-height: 1.3334; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.05em; margin-bottom: 0.2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #820f16; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: #222222; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

.literalblock pre, .listingblock pre { background: #333333; }

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Arquitectura de Redes Avanzadas</h1>
<div class="details">
<span id="author" class="author">Diego Fernández</span><br>
<span id="revnumber">version 0.1.0</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Índice</div>
<ul class="sectlevel1">
<li><a href="#_tema_2_encaminamiento_interdominio">Tema 2: Encaminamiento interdominio</a>
<ul class="sectlevel2">
<li><a href="#_generalidades">Generalidades</a>
<ul class="sectlevel3">
<li><a href="#_sistemas_autónomos">Sistemas autónomos</a></li>
<li><a href="#_políticas_de_uso">Políticas de uso</a></li>
</ul>
</li>
<li><a href="#_bgp">BGP</a>
<ul class="sectlevel3">
<li><a href="#_aspectos_generales">Aspectos generales</a></li>
<li><a href="#_establecimiento_de_vecindades">Establecimiento de vecindades</a></li>
<li><a href="#_intercambio_de_infomación_de_encaminamiento">Intercambio de infomación de encaminamiento</a></li>
<li><a href="#_selección_de_ruta">Selección de ruta</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_tema_3_introducción_a_ipv6">Tema 3: Introducción a IPv6</a>
<ul class="sectlevel2">
<li><a href="#_generalidades_2">Generalidades</a></li>
<li><a href="#_formato_de_paquete">Formato de paquete</a>
<ul class="sectlevel3">
<li><a href="#_cabeceras_de_extensión">Cabeceras de extensión</a></li>
</ul>
</li>
<li><a href="#_direccionamiento">Direccionamiento</a>
<ul class="sectlevel3">
<li><a href="#_asignación">Asignación</a></li>
<li><a href="#_representación">Representación</a></li>
<li><a href="#_tipos_de_direcciones">Tipos de direcciones</a></li>
</ul>
</li>
<li><a href="#_icmpv6">ICMPv6</a>
<ul class="sectlevel3">
<li><a href="#_descubrimiento_de_mtu">Descubrimiento de MTU</a></li>
<li><a href="#_establecimiento_de_vecindades_2">Establecimiento de vecindades</a></li>
<li><a href="#_ventajas_de_icmpv6">Ventajas de ICMPv6</a></li>
<li><a href="#_descubrimiento_de_destinos_em_multicast_em_mld">Descubrimiento de destinos <em>multicast</em> (MLD)</a></li>
</ul>
</li>
<li><a href="#_dhcpv6">DHCPv6</a></li>
<li><a href="#_encaminamiento">Encaminamiento</a></li>
<li><a href="#_soporte_sobre_protocolos_de_enlace">Soporte sobre protocolos de enlace</a></li>
<li><a href="#_dns">DNS</a></li>
<li><a href="#_migración">Migración</a>
<ul class="sectlevel3">
<li><a href="#_pilas_duales">Pilas duales</a></li>
<li><a href="#_tunelado">Tunelado</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_tema_2_encaminamiento_interdominio">Tema 2: Encaminamiento interdominio</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_generalidades">Generalidades</h3>
<div class="sect3">
<h4 id="_sistemas_autónomos">Sistemas autónomos</h4>
<div class="paragraph">
<p>Son un conjunto de redes que comparten una estrategia de encaminamiento común,
posiblemente gestionadas por una misma administración. Para identificar
un sistema autónomo se precisa un identificador único. Se pueden tener dos
tipos de encaminamiento:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Interdominio</strong>: Se usa una única métrica con coste a minimizar.</p>
</li>
<li>
<p><strong>Intradominio</strong>: Existen varias métricas posibles a lo largo de una ruta. No
hay un coste directo asociado a una única ruta, en su lugar se usa una función
compleja que depende de diferentes características.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Algunas características deseables son:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Topología arbitraria</p>
</li>
<li>
<p>Expresividad</p>
</li>
<li>
<p>Escalabilidad</p>
</li>
<li>
<p>Intercambio de información mínima</p>
</li>
<li>
<p>Convergencia rápida</p>
</li>
<li>
<p>Ausencia de bucles</p>
</li>
<li>
<p>Independencia entre organizaciones</p>
</li>
<li>
<p>Independencia del protocolo intradominio</p>
</li>
<li>
<p>Lentitud de cambio</p>
</li>
<li>
<p>Descentralización de funciones</p>
</li>
<li>
<p>Independencia de protocolo de red</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
El flujo de tráfico siempre va en dirección opuesta al flujo de encaminamiento.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_políticas_de_uso">Políticas de uso</h4>
<div class="paragraph">
<p>Las políticas de uso son unas reglas administrativas que afectan a la elección
de la ruta. Pueden depender de los siguientes parámetros:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Cambio</p>
</li>
<li>
<p>Calidad de servicio</p>
</li>
<li>
<p>Clase de usuarios</p>
</li>
<li>
<p>Tiempo</p>
</li>
<li>
<p>Autenticación</p>
</li>
<li>
<p>No interferencia y límite de recursos</p>
</li>
<li>
<p>Tipo de aplicación</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Las políticas se pueden clasificar de la siguiente forma:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Política</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Acceso</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Selección</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Tarificación</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Origen</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Destino</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Tránsito</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_bgp">BGP</h3>
<div class="sect3">
<h4 id="_aspectos_generales">Aspectos generales</h4>
<div class="paragraph">
<p><strong>BGP</strong> (<em>Border Gateway Protocol</em>) permite:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Recabar información de alcanzabilidad de los <strong>AS</strong> vecinos.</p>
</li>
<li>
<p>Propagar dicha información de forma interna.</p>
</li>
<li>
<p>Determinar buenas rutas basándose en dicha información y teniendo en cuenta
políticas de uso.</p>
</li>
<li>
<p>Anunciar las propias subredes al resto de Internet (Esto es obligatorio).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Un <strong>ASN</strong> es un número de Sistema Autónomo. Se trata de un identificador de 16 ó
32 bits definido por la <a href="https://tools.ietf.org/html/rfc4893">RFC4893</a>.
Los identificadores entre 1 y 64511 son asignados por autoridades de registro,
mientras que el rango 64512 a 65534 son de uso privado, es decir,
están prohibidos en Internet. El 0 y el 65535 están reservados.
El identificador puede ser asignado por el ISP o por RIR (subdelegado de IANA).
En BGP un camino o ruta será una secuencia de <strong>ASNs</strong>.</p>
</div>
<div class="paragraph">
<p>BGP sólamente es necesario para los proveedores de servicio o para usuarios
que requieran de una conexión a más de un proveedor de servicio.</p>
</div>
<div class="paragraph">
<p>BGP realiza un encaminamiento <strong>salto a salto</strong>, <strong>distribuido</strong> y <strong>jerárquico</strong>.
Se caracteriza por que el establecimiento de vecindades es <strong>manual</strong>, el
intercambio de información de encaminamiento se basa en un <strong>vector de caminos</strong>.
El cálculo de las rutas se hace buscando el <strong>camino más corto</strong> teniendo en
cuenta las <strong>políticas de uso</strong>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_establecimiento_de_vecindades">Establecimiento de vecindades</h4>
<div class="paragraph">
<p>En BGP el establecimiento de vecindades se realiza de forma <strong>manual</strong>.
Se pueden encontrar dos tipos de vecinos: <strong>vecinos internos</strong> y <strong>vecinos
externos</strong> dependiendo si se encuentran dentro del mismo AS o en otro AS.</p>
</div>
<div class="paragraph">
<p><strong>iBGP</strong> es el protocolo usado entre vecinos <strong>internos</strong> o que se encuentran en
el mismo AS. Estos vecinos no tienen por qué ser adyacentes. Para que el
protocolo funcione correctamente, los routers deben encontrarse conectados
en <strong>malla total</strong>. Debe ser implementado en todos los <strong>routers internos entre
conexiones al exterior</strong>.</p>
</div>
<div class="paragraph">
<p><strong>eBGP</strong> se usa entre vecinos <strong>externos</strong> o que se encuentran en diferentes AS,
habitualmente adyacentes. Se envía una ruta por destino con los atributos
importantes. Cuando se envía la ruta <strong>se añade el pripio ASN</strong> a la secuencia
de ASNs y el atributo "siguiente salto" es sobreescrito.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>Lo que se aprende por <strong>eBGP</strong> se comunica por <strong>iBGP</strong></p>
</li>
<li>
<p>Lo que se aprende por <strong>iBGP</strong> se comunica por <strong>eBGP</strong></p>
</li>
<li>
<p>Lo <strong>no</strong> se aprende por <strong>eBGP</strong> <strong>no</strong> se comunica por <strong>iBGP</strong></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_intercambio_de_infomación_de_encaminamiento">Intercambio de infomación de encaminamiento</h4>
<div class="paragraph">
<p>Los vecinos BGP intercambian rutas basadas en una secuencia de ASNs. Siempre
que se propaga una ruta se le sufija a la salida el ASN propio, además se
incrementa el número de saltos cada vez que se atraviesa un AS. Debido a que
las rutas se almacenan <strong>es posible detectar y eliminar bucles</strong>.</p>
</div>
<div class="paragraph">
<p>Dentro del propio AS no se contempla la métrica, la capacidad de la ruta,
el número de saltos dentro de cada AS o el retardo.</p>
</div>
<div class="paragraph">
<p>Cada router puede aprender rutas de los vecinos BGP externos usando eBGP o de
otros encaminadores de su AS que tengan vecinos externos mediante iBGP. Es
posible que las rutas puedan ser descartadas si así se configura en las
políticas.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Se propaga sólo la mejor ruta calculada.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>Router A in AS100
  interface ethernet 5/0
  ip address 222.222.10.2 255.255.255.240 <i class="conum" data-value="1"></i><b>(1)</b>
  !

  router bgp 100 <i class="conum" data-value="2"></i><b>(2)</b>
  network 220.220.8.0 mask 255.255.252.0
  neighbor 222.222.10.1 remote-as 101 <i class="conum" data-value="3"></i><b>(3)</b>
  neighbor 222.222.10.1 prefix-list RouterC in <i class="conum" data-value="4"></i><b>(4)</b><i class="conum" data-value="5"></i><b>(5)</b>
  neighbor 222.222.10.1 prefix-list RouterC out <i class="conum" data-value="5"></i><b>(5)</b>
  !</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Dirección IP en la interfaz ethernet</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>ASN local</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>ASN remoto</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Dirección IP de <code>RouterC</code></td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Filtros entrantes y salientes</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>Sólo puede haber una ruta a cada bloque de IPs al mismo tiempo</p>
</li>
<li>
<p>Al establecer vecindad se intercambia todo el vector y después sólamente
se actualizan los cambios.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_rutas_bgp">Rutas BGP</h5>
<div class="paragraph">
<p>La ruta BGP se compone de un <strong>prefijo</strong> y unos <strong>atributos</strong>. El prefijo es la
partición del espacio de rutas cuya alcanzabilidad se está anunciando. Se
envía la dirección inicial de la subred y la máscara. Inicialmente sólo
funcionaba con IPv4 (<a href="https://tools.ietf.org/html/rfc4760">RFC4760</a>).
Los atributos pueden ser <strong>reconocidos</strong> u <strong>opcionales</strong>.</p>
</div>
<div class="paragraph">
<p>Los atributos de las rutas BGP son:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>AS-PATH</code> [obligatorio]</strong>: Identifica a los AS a través de los que ha llegado
el prefijo. Permite detectar bucles y se incrementa con cada salida de un AS.
Siempre se prefieren las rutas con un <strong><code>AS-PATH</code> más corto</strong>.</p>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>192.67.95.0/24</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3847 701</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>140.222.0.0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3847 1673</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>204.70.0.0/15</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3847 3561</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>207.240.0.0/16</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3847</code></p></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong><code>NEXT-HOP</code> [obligatorio]</strong>: Indica la dirección IP del router que debe
usarse para las rutas anunciadas.</p>
</li>
<li>
<p><strong>Origen [obligatorio]</strong>: Indica la procedencia de la información que se
propaga: IGP, EGP o desconocido en ese orden de preferencia.</p>
</li>
<li>
<p><strong>Preferencia local [discrecional]</strong>: Sólo se usa en iBGP. Permite indicar el
router propio que se prefiere como salida. Se prefiere el router con el valor
más alto.</p>
</li>
<li>
<p><strong>Discriminador de salida múltiple [no transitivo]</strong>: Indica a los vecinos
<strong>externos</strong> el enlace de entrada preferido y afecta a todas las rutas con el
mismo <code>AS-PATH</code></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_mensajes_bgp">Mensajes BGP</h5>
<div class="paragraph">
<p>Los mensajes BGP se usan sobre el protocolo TCP (puerto 179). Los posibles
mensajes son:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>OPEN</code>: Abre la conexión y autentica al emisor.</p>
</li>
<li>
<p><code>UPDATE</code>: Anuncia nuevas rutas o borra las viejas.</p>
</li>
<li>
<p><code>KEEPALIVE</code>: Mantiene la conexión en ausencia de <code>UPDATE</code>, o asiente un
mensaje <code>OPEN</code>.</p>
</li>
<li>
<p><code>NOTIFICATION</code>: Informa de errores en el mensaje precedente o libera la
conexión.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Si se cae la conexión TCP todas las rutas aprendidas por dicha conexión
deben eliminarse.</p>
</div>
</div>
<div class="sect4">
<h5 id="_anuncios_de_ruta">Anuncios de ruta</h5>
<div class="paragraph">
<p>Mediante iBGP sólo se envían las rutas que se aprenden directamente de vecinos
eBGP, no las que se aprenden de vecinos iBGP. Es necesario que todos los
routers que ejecutan iBGP estén conectados en malla total. Se envían todos
los atributos. El valor de <code>NEXT-HOP</code> no se modifica en los saltos entre
routers iBGP, sólamente entre saltos de AS a AS.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_selección_de_ruta">Selección de ruta</h4>
<div class="paragraph">
<p>La ruta se elige en el siguiente orden teniendo en cuenta que se descartan
todas las rutas que tienen un <code>NEXT-HOP</code> inalcanzable:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ruta más específica</p>
</li>
<li>
<p>Mayor preferencia local</p>
</li>
<li>
<p>Ruta generada localmente</p>
</li>
<li>
<p><code>AS-PATH</code> más corto</p>
</li>
<li>
<p><code>NEXT-HOP</code> más cercano</p>
</li>
<li>
<p>Menor origin (IGP &lt; EGP &lt; desconocido)</p>
</li>
<li>
<p>Menor métrica en destino</p>
</li>
<li>
<p>eBGP &gt; iBGP</p>
</li>
<li>
<p>Menor coste IGP al siguiente salto</p>
</li>
<li>
<p>Menor ID de router</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Hay que tener en cuenta que las políticas pueden determinar la
aceptación o el rechazo de una ruta que llega en un mensaje <code>UPDATE</code>.
Estás políticas se basan en el prefijo o en el <code>AS-PATH</code>. Todas las rutas
que se rechazan no se llegan a considerar en el proceso de elección.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Al conformar iBGP una malla total de routers,
pueden aparecer problemas de escalabilidad. También pueden existir problemas
con los mensajes <code>UPDATE</code> cuando la red crece demasiado o cuando se cambia
una política que debe propagarse, ya que puede causar oscilaciones.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Existen diferentes técnicas para mitigar los problemas de escalabilidad:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Refresco de rutas</strong>: Un cambio de políticas requiere un reinicio manual de
BGP porque las rutas descartadas con las políticas antiguas no se habían
guardado. El reinicio es costoso, disruptivo y lento.</p>
<div class="paragraph">
<p>Como solución se puede hacer una petición (también manual) de refresco de todas
las rutas tras el cambio de políticas.</p>
</div>
</li>
<li>
<p><strong>Grupos de vecinos</strong>: Los vecinos iBGP se encuentran en malla total y reciben
copias idénticas del mismo mensaje <code>UPDATE</code> provocando que muchos de los
cálculos sean repetidos.</p>
<div class="paragraph">
<p>Como solución se pueden agrupar todos los vecinos que tengan una misma
política de <strong>salida</strong> y genera sólamente un mensaje <code>UPDATE</code> para ese grupo.</p>
</div>
</li>
<li>
<p><strong>Mitigación de oscilaciones</strong>: Cambio oscilante en la ruta por cambio de
algún atributo, con efecto de largo alcance.</p>
<div class="paragraph">
<p>Como solución se puede intentar predecir el comportamiento futuro y
suprimir las rutas que oscilen y anunciar sólo las estables.</p>
</div>
<div class="paragraph">
<p>Para los anuncios entrates de vecinos externos se puede penalizar cada cambio
que se produzca y, posteriormente, ir decrementando la penalización con el
tiempo. Si se supera un umbral la ruta ya no se propaga por considerarse
"inestable". Si la ruta se estabiliza se puede volver a anunciar.</p>
</div>
</li>
<li>
<p><strong>Confederaciones y reflectores de rutas</strong>: Los vecinos iBGP se conectan en
malla total. Las mallas totales <strong>no son escalables</strong>.</p>
<div class="paragraph">
<p>Como solución se pueden añadir más niveles jerárquicos. Entre <em>subASs</em> se usa
eBGP, como si fuesen vecinos externos, pero conservando <code>NEXT-HOP</code>,
<code>LOCAL_PREF</code> y <code>MED</code>. Dentro del <em>subAS</em> se usa malla total e iBGP. Desde
fuera del AS se vería todo exactamente igual.</p>
</div>
<div class="paragraph">
<p>Otra solución es usar <strong>reflectores de rutas</strong>. Los reflectores de rutas son
vecinos iBGP que actúan como informadores de rutas para otros routers
iBGP. Los reflectores de rutas sí están mallados. Cuando un reflector de
ruta recibe una ruta de uno de sus clientes iBGP la anuncia al resto de los
clientes iBGP. Cuando recibe una ruta de otro dispositivo que no sea un
cliente suyo anuncia la ruta <strong>sólamente a sus clientes</strong>. Se permite, por
robustez, a un router iBGP ser cliente de varios reflectores de rutas
al mismo tiempo.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Pese a que la solución de dividir el AS en <em>subASs</em> parece más natural, en
la práctica es preferida la solución de los <strong>reflectores de rutas</strong>.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tema_3_introducción_a_ipv6">Tema 3: Introducción a IPv6</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_generalidades_2">Generalidades</h3>
<div class="paragraph">
<p>La necesidad de IPv6 se debe a las ineficiencas de la versión anterior, IPv4.
En IPv4 tenemos una complejidad innecesaria debido a las <strong>opciones de longituid
variables</strong>, la <strong>costosa fragmentación</strong> y el formato del paquete <strong>no es
extensible</strong>.
Además en IPv4 el número de direcciones es actualmente insuficiente para
cubrir toda la demanda ya que hoy en día tenemos terminales que están siempre
activos, por lo que necistan un dirección <strong>en todo momento</strong>. La telefonía y el
IoT exige un gran cantidad de direcciones así como los países emergentes. Otro
problema son las <strong>deficiencias en las asignaciones</strong>.</p>
</div>
<div class="paragraph">
<p>Otro problema con IPv4 es que ha ido solucinando una serie de necesidades que
iban apareciendo sobre la marcha, por ejemplo: IPSec, Mobile IP, QoS, DHCP,
NAT, etc.</p>
</div>
<div class="paragraph">
<p>Una solución para la falta de direcciones fue NAT
(<em>Network Address Translation</em>), sin embargo, es sólamente válido como una
solución <strong>temporal</strong>, puesto que limita el número de servidores internos,
impide el funcionamiento de aplicaciones P2P, afecta al rendimiento, robustez
y seguridad y no resuelve totalmente el problema de la escasez de direcciones.</p>
</div>
<div class="paragraph">
<p>IPv6 viene a suplir estos problemas de IPv4. En resumen IPv6 se carateriza por:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Capacidades de direccionamiento extendidas.</p>
</li>
<li>
<p>Estructura jerárquica que permite tablas de encaminamiento más compactas.</p>
</li>
<li>
<p>Auto configuración y reconfiguración automáticas.</p>
</li>
<li>
<p>Cabecera optimizada y soporte de flujos.</p>
</li>
<li>
<p>Soporte mejorado para opciones y extensiones.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_formato_de_paquete">Formato de paquete</h3>
<div class="paragraph">
<p>Los cambios respecto a IPv4 tienen el objetivo de acelerar el procesado de los
paquetes en los routers, para ello se pretende:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Eliminar la información opcional en la cabecera básica</p>
</li>
<li>
<p>Reducir el número de campos</p>
</li>
<li>
<p>Eliminar los campos de longitud variable</p>
</li>
<li>
<p>Eliminar los campos de flags</p>
</li>
<li>
<p>Añadir extensibilidad más flexible</p>
</li>
<li>
<p>Alinear a 64 bits</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Los cambios respecto a los paquetes IPv4 son:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Eliminaciones</p>
<div class="ulist">
<ul>
<li>
<p>Se eliminan el tratamiento de la fragmentación</p>
</li>
<li>
<p>Se eliminan las opciones IP</p>
</li>
<li>
<p>Se elimina la suma de verificación</p>
</li>
<li>
<p>Se elimine el campo de longitud de la cabecera</p>
</li>
<li>
<p>El campo de longitud excluye la cabecera</p>
</li>
<li>
<p>Alineado a 64 bits</p>
</li>
</ul>
</div>
</li>
<li>
<p>Redenominaciones</p>
<div class="ulist">
<ul>
<li>
<p>Tiempo de vida: número de saltos</p>
</li>
<li>
<p>Protocolo: siguiente cabecera</p>
</li>
<li>
<p>Precedencia y tipo de servicio: clase de tráfico</p>
</li>
<li>
<p>Longitud de direcciones de 32 a 128 bits</p>
</li>
</ul>
</div>
</li>
<li>
<p>Extensiones</p>
<div class="ulist">
<ul>
<li>
<p>Etiqueta de flujo</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock text-center">
<div class="title">Paquete IPv6</div>
<div class="content">
<pre>0        4        8        12       16       20       24       31
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Version| Traffic Class |           Flow Label                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Payload Length        |  Next Header  |   Hop Limit   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                         Source Address                        +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                      Destination Address                      +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Next Header  |  Hdr Ext Len  |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                                                               |
.                                                               .
.                            Options                            .
.                                                               .
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre>
</div>
</div>
<div class="paragraph">
<p>Nos encontramos con las siguientes cabeceras en IPv6:</p>
</div>
<div class="sect3">
<h4 id="_cabeceras_de_extensión">Cabeceras de extensión</h4>
<div class="paragraph">
<p>Sustituyen los campos de <strong>opciones</strong> y <strong>protocolo encapsulado</strong>. Esta cabecera
<strong>sólamente se procesa en el destino</strong> (excepto la cabecera salto a salto).</p>
</div>
<div class="listingblock text-center">
<div class="title">Cabecera de extensión</div>
<div class="content">
<pre>+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Next Header  |  Hdr Ext Len  |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                                                               |
.                            Options                            .
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre>
</div>
</div>
<div class="paragraph">
<p>Están definidas las siguiente cabeceras de extensión:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Salto a salto</strong>: Es la única procesada por cada salto intermedio,
es decir, por cada router. Ejemplo: jumbograma, el TLV lleva un campo de
longitud extra de 32 bits, que da para paquetes de hasta 4GB.</p>
</li>
<li>
<p><strong>Opciones de destino</strong>: Sólo si hay de encaminamiento. Procesada sólo en el
destino o destinos. Ejemplo de uso: soporte de movilidad.</p>
</li>
<li>
<p><strong>De encaminamiento</strong>: Procesada por los routers intermedios que se indiquen.
Puede aparecer la primera o tras otra cabecera de extensión. El tipo de
encaminamiento 0 es similar a la opción de encaminamiento laxo de IPv4.</p>
</li>
<li>
<p><strong>De fragmento</strong>: Se usa para enviar paquetes mayores que la MTU. Nunca se
fragmentan por lor routers. <strong>No se aconseja su uso</strong>.</p>
</li>
<li>
<p><strong>De autenticación</strong>: Para autenticación IPsec.</p>
</li>
<li>
<p><strong>ESP</strong>: Cabecera de encapsulado de seguridad.</p>
</li>
<li>
<p><strong>De movilidad</strong></p>
</li>
<li>
<p><strong>Opciones de destino</strong>: Si no hay de encaminamiento.</p>
</li>
<li>
<p><strong>Protocolo encapsulado</strong>: UDP, TCP, ICMP, SCTP, OSPF, etc.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Las cabeceras de extensión deben aparecer en dicho orden.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_direccionamiento">Direccionamiento</h3>
<div class="paragraph">
<p>En IPv6 hay direcciones de <strong>128 bits</strong> divididas en tres campos de longitud
variable:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>GRP</strong> (<em>Global Routing Prefix</em>): Identifica el tipo de dirección.</p>
</li>
<li>
<p><strong>Subred</strong>: Identifica al enlace.</p>
</li>
<li>
<p><strong>ID de interfaz</strong>: Identifica una interfaz en el enlace.</p>
</li>
</ul>
</div>
<div class="listingblock text-center">
<div class="content">
<pre>+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    GRP    |    ID de Subred    |         ID de Interfaz       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Cualquier campo puede ir todo a 0 o todo a 1.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_asignación">Asignación</h4>
<div class="paragraph">
<p>El identificador de interfaz es la última parte de la dirección. Sirve para
identificar una dirección dentro de un enlace, por lo que debe ser única dentro
de dicho enlace (también puede serlo globalmente). Hay varias formas en la que
una interfaz puede obtener una dirección:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>EUI-64 (<em>IEEE Extended Unique Identifier 64</em>): Para las LANs futuras.</p>
</li>
<li>
<p>Expandido de una dirección 802.1 de 48 bits. Se construye insertando <code>FFFE</code> en
el centro y complementando el bit <code>u/g</code>:</p>
<div class="listingblock">
<div class="content">
<pre>MAC:    00:C0:FE:12:3A:4F
EUI-64: 02:C0:FE:FF:FE:12:3A:4f</pre>
</div>
</div>
</li>
<li>
<p>Número pseudoaleatorio autogenerado.</p>
</li>
<li>
<p>Obtenida mediante DHCP.</p>
</li>
<li>
<p>Asignada manualmente.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_representación">Representación</h4>
<div class="listingblock">
<div class="content">
<pre>2031:0000:130F:0000:0000:09C0:876A:130B <i class="conum" data-value="1"></i><b>(1)</b>
http://[2001:DB8:1003::f]:8080/index.html <i class="conum" data-value="2"></i><b>(2)</b>
2000::/3 <i class="conum" data-value="3"></i><b>(3)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Dirección IPv6</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Dirección IPv6 en una URL</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Dirección IPv6 con máscara</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Hay una serie de simplificaciones que pueden realizarse sobre una dirección IP:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Los ceros iniciales son opcionales</p>
</li>
<li>
<p>Los campos a 0 sucesivos pueden colapsarse <strong>una sóla vez</strong></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">IPv6 simplificada</div>
<div class="content">
<pre>2031:0:130F::9C0:876A:130B</pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Ojo con las compresiones:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>CAFF:CA01:0000:0056:0000:ABCD:EF12:1234/64
CAFF:CA01::56/64</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_tipos_de_direcciones">Tipos de direcciones</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>La misma interfaz puede tener varias interfaces, de cualquier tipo.</p>
</li>
<li>
<p>No hay direcciones de difusión.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Existen dos direcciones especiales:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>::</code>: Dirección no especificada (todo ceros). Se usa cuando no se sabe cuál
es la propia, por ejemplo, al pedir una dirección mediante DHCP.</p>
</li>
<li>
<p><code>::1</code>: Autodirección, equivale a la <code>127.0.0.1</code> en IPv4.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_direcciones_unicast">Direcciones unicast</h5>
<div class="paragraph">
<p>Las direcciones unicast pueden ser:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Global agregable</strong>: <code>2000::/3</code>. Son utilizables para el
encaminamiento y estructuradas para que puedan agregarse. Un espacio de
direccionamiento tan grande necesita agregación eficiente para ser escalable.
Permite multiubicación (<em>multihoming</em>) sin usar BGP.</p>
<div class="listingblock text-center">
<div class="content">
<pre>+------------------------+-----------+----------------------------+
| 001 |     GRP          |    SLA    |      ID de Interfaz        |
+------------------------+-----------+----------------------------+</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>SLA (<em>Site-Level Aggregator</em>): Usada por el poseedor del GRP para
organizar su red de forma jerárquica.</p>
</li>
<li>
<p>ID de Interfaz: Identifica interfaces en un enlace (subred) en formato
EUI-64 modificado.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Local a la ubicación</strong> (<em>site local</em>): <code>FEC0::/10</code>. Son similares
a las direcciones IPv4 <code>192.168.x.x</code>, por lo que <strong>no debería aparecer en
Internet</strong>. Están cosideradas obsoletas y reemplazadas por las direcciones
localmente unicas.</p>
</li>
<li>
<p><strong>Local al enlace</strong> (<em>link local</em>): <code>FE80::/10</code>. Usan el formato
EUI-64 modificado. Se usan durante la configuración, similar a las direcciones
IPv4 <code>169.254.0.0</code>, o cuando no hay routers (no son encaminables).</p>
</li>
<li>
<p><strong>Local única</strong> (<em>unique local</em>): <code>FC00::/8</code> o <code>FD00::/8</code>. Son direcciones
encaminables, pero <strong>sólamente en un área limitada</strong>, no hacia Internet. El prefijo
puede llegar hasta <code>/48</code> localmente único para mejor filtrado. Los 40 bits
restantes deben generarse <strong>de forma aleatoria</strong>. En caso de fugas (hacia
Internet) no hay problemas ya que llevan un prefijo único. Si conectan dos
áreas la probabilidad de colisión es baja. Son direcciones IP independientes
de la operadora.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_direcciones_ipv4_e_ipv6">Direcciones IPv4 e IPv6</h6>
<div class="paragraph">
<p>Todas las direcciones IPv4 caben dentro del rango IPv6. Hay diferentes formas
de elegir direcciones IPv6 que se puedan utilizar en conjunto con IPv4:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Direcciones IPv6 compatibles</strong>: Usan el prefijo <code>::96</code>, por ejemplo,
<code>::193.147.162.130</code>. Se usa para formas túneles de forma automática. <strong>No son
escalables</strong>, por lo que actualmente se encuentran en desuso.</p>
</li>
<li>
<p><strong>Direcciones IPv6 mapeadas</strong>: Usan el prefijo <code>::FFFF:/96</code>, por ejemplo,
<code>::FFFF:193.147.162.130</code>. Son habituales en casos donde se usan ambas versiones.
Un <em>socket</em> atiende en ambas direcciones al mismo tiempo y la aplicación envía
los paquetes con destino mapeado.</p>
</li>
<li>
<p><strong>Direcciones 6to4</strong>: Son del tipo <code>2002:XXXX:XXXX::/48</code>, donde <code>XXXX:XXXX</code> es
la dirección IPv4.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_elección_de_direcciones">Elección de direcciones</h6>
<div class="paragraph">
<p>Al tener varias posibles direcciones se puede escoger cuál utilizar en cada
caso. Se sigue el siguiente orden de prioridad a la hora de elegir una
dirección:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Para el origen</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>La misma con la que llegó el paquete que se responde</p>
</li>
<li>
<p>La de ámbito más restringido</p>
</li>
<li>
<p>La que no esté en desuso</p>
</li>
<li>
<p>La local</p>
</li>
<li>
<p>La de la interfaz de salida</p>
</li>
<li>
<p>La más conveniente para el destino (por ejemplo IPv4 mapeada)</p>
</li>
<li>
<p>La temporal</p>
</li>
<li>
<p>La de prefijo coincidente más larga</p>
</li>
</ol>
</div>
</li>
<li>
<p>Para el destino</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Evitar las inútiles (por ejemplo que no se tenga ruta)</p>
</li>
<li>
<p>La del mismo ámbito</p>
</li>
<li>
<p>La local</p>
</li>
<li>
<p>La más conveniente</p>
</li>
<li>
<p>La de prefijo coincidente más largo</p>
</li>
<li>
<p>Según el orden devuelto por el DNS</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_direcciones_em_multicast_em">Direcciones <em>multicast</em></h5>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Debido a que las direcciones <em>broadcast</em> son costosas ya que interrumpe a todos
los dispositivos que se encuentran en el enlace, se opta por no usarlas en
IPv6, las direcciones de <em>multicast</em> juegan ese papel.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Las direcciones <em>multicast</em> se puede asignar a varias interfaces de distintos
equipos y el paquete se entregará a todos ellos. Son del tipo:</p>
</div>
<div class="listingblock text-center">
<div class="content">
<pre>+----+----+-------------------------------------------------------+
| FF | AB |              Grupo multicast (112 bits)               |
+----+----+-------------------------------------------------------+</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>A es el <em>flag bit</em> de la forma <code>0RPT</code></p>
<div class="ulist">
<ul>
<li>
<p><code>0</code>: Reservado</p>
</li>
<li>
<p><code>R</code>: Punto de encuentro empotrado (encaminamiento <em>multicast</em>)</p>
</li>
<li>
<p><code>P</code>: Dirección asignada basada en el prefijo <em>unicast</em></p>
</li>
<li>
<p><code>T</code>: Dirección dinámica o reconocida</p>
</li>
</ul>
</div>
</li>
<li>
<p>B es el ámbito</p>
<div class="ulist">
<ul>
<li>
<p><code>1</code>: Local a la interfaz (loopback)</p>
</li>
<li>
<p><code>2</code>: Local al enlace (no rutable)</p>
</li>
<li>
<p><code>4</code>: Local al ámbito administrativo</p>
</li>
<li>
<p><code>5</code>: Local a la ubicación (red física)</p>
</li>
<li>
<p><code>8</code>: Local a la organización (múltiples ubicaciones, uso en VPNs)</p>
</li>
<li>
<p><code>E</code>: Global (puede salir a Internet)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_direcciones_reservadas">Direcciones reservadas</h6>
<div class="paragraph">
<p>Hay algunas direcciones multicast reservadas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>FF01::1</code>, todas las intrfaces del nodo</p>
</li>
<li>
<p><code>FF02::1</code>, todos los nodos del enlace</p>
</li>
<li>
<p><code>FF02::2</code>, todos los routers del enlace</p>
</li>
<li>
<p><code>FF02::9</code>, todos los routers RIP del enlace</p>
</li>
<li>
<p><code>FF05::1:3</code>, todos los servidores DHCP en la red local</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_dirección_multicast_de_nodo_solicitado">Dirección multicast de nodo solicitado</h6>
<div class="paragraph">
<p>Son direcciones <em>multicast</em> que sólo escucha un nodo concreto. Tienen la forma
<code>FF02::1:FFXX:XXXX</code> donde <code>XX:XXXX</code> se toman de los 24 bits menos significativos
del identificador de interfaz. Todos los nodos tienen esta dirección. Se mapea
directamente a la <em>multicast</em> del enlace.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Mientras que en IPv4 hay que obtener la direcciones <em>multicast</em>, en IPv6 los
prefijos <em>unicast</em> conllevan prefijos <em>multicast</em>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="_ejemplo_de_dirección_em_multicast_em">Ejemplo de dirección <em>multicast</em></h6>
<div class="listingblock text-center">
<div class="content">
<pre>+----+-------+--------+------+------+------------------+-------------+
+  8 |   4   |    4   |   8  |   8  |        64        |      32     |
+----+-------+--------+------+------+------------------+-------------+
| FF | Flags | Ámbito | RSVD | Plen |  Network-Prefix  |  Group-ID   |
+----+-------+--------+------+------+------------------+-------------+
| FF |       3E       |  00  |  40  |  2001:DB8:100:E  |  0000:1111  |
+----+-------+--------+------+------+------------------+-------------+</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>A = 3 = 0b0011</code></p>
<div class="ulist">
<ul>
<li>
<p><code>R = 0</code>: No es un punto de encuentro empotrado.</p>
</li>
<li>
<p><code>P = 1</code>: Es una dirección basada en el prefijo unicast.</p>
</li>
<li>
<p><code>T = 1</code>: Es una dirección dinámica.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>B = E</code>: Es una dirección global (puede salir a Internet).</p>
</li>
<li>
<p><code>RSVD = 00</code></p>
</li>
<li>
<p><code>Plen = 0x40 = 64</code>: La dirección del prefijo de red (<em>Network-Prefix</em>) es de
64 bytes.</p>
</li>
<li>
<p>Prefijo de red: <code>2001:DB8:100:E</code>.</p>
</li>
<li>
<p>ID de grupo: <code>0000:1111</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_correspondencia_ipv6_multicast_con_direcciones_iee_802_1_48_bits">Correspondencia IPv6 multicast con direcciones IEE 802.1 48 bits</h6>
<div class="listingblock text-center">
<div class="content">
<pre>+----+-------+--------+-----------------------+----------------------+
+  8 |   4   |    4   |           80          |           32         |
+----+-------+--------+-----------------------+----------------------+
| FF | Flags | Ámbito |   Más significativos  | Menos significativos |
+----+-------+--------+---------------+-------+----------------------+
                                      | 33:33 |     XX:XX:XX:XX      |
                                      |-------+----------------------+
                                      |              48              |
                                      +------------------------------+</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Los bits más significativos se pierden en la correspondencia.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_direcciones_em_anycast_em">Direcciones <em>anycast</em></h5>
<div class="paragraph">
<p>Son direcciones asignadas a varias interfaces de <strong>routers</strong> distintos. El paquete
se entrega al <strong>más cercano</strong>. Las direcciones se encuentran en el mismo espacio
que las direcciones <em>unicast</em>. Nunca deben usarse como direcciones de origen,
ni por un sistema final (no router).</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Su uso es en parte expermiental
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_direcciones_imprescindibles">Direcciones imprescindibles</h5>
<div class="paragraph">
<p>Una interfaz requiere:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Su dirección local al enlace (de autoconfiguración)</p>
</li>
<li>
<p>Su dirección de bucle (autodirección o loopback)</p>
</li>
<li>
<p>Una dirección unicast</p>
</li>
<li>
<p>La multicast "a todos los nodos"</p>
</li>
<li>
<p>La multicast solicitada para cada unicast y anycast que tenga</p>
</li>
<li>
<p>Las multicast de los grupos a los que pertenezca</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Si además es de un router:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>La anycast de las subredes en las interfaces en las que actúa de router</p>
</li>
<li>
<p>La multicast "a todos los routers"</p>
</li>
<li>
<p>Las anycast que tenga configuradas</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_obtención_de_direcciones_ipv6">Obtención de direcciones IPv6</h5>
<div class="paragraph">
<p>Las direcciones IPv6 son asignadas de forma jerárquica por la IANA según
ubicación. IANA asigna dentro del rango <code>2000::/3</code>, un <code>/12</code> a cada RIR. Las
direcciones se asignan a ISPs, no a empresas. Se reparte de forma que:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Se asigna una partición <code>/48</code> por omisión</p>
</li>
<li>
<p>Se asigna una partición <code>/64</code> si se sabe que sólo habrá una subred.</p>
</li>
<li>
<p>Se asigna una partición <code>/128</code> (una única dirección) si se sabe que es un
usuario final con un único equipo.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_icmpv6">ICMPv6</h3>
<div class="listingblock text-center">
<div class="title">Paquete ICMPv6</div>
<div class="content">
<pre>+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Tipo       |     Código     |  Suma de comprobación   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                                                               +
|                         Datos ICMPv6                          |
+                                                               +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre>
</div>
</div>
<div class="paragraph">
<p>ICMPv6 se trata de una versión mejorada de ICMP. Incorpora IGMP, ARP/RARP,
establecimiento de vecindades y movilidad. El código de cabecera es <strong>58</strong>. Se
dispone de los siguiente tipos de mensaje:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Mensajes de error</p>
<div class="ulist">
<ul>
<li>
<p>Destino inalcanzable</p>
</li>
<li>
<p>Paquete demasiado grande</p>
</li>
<li>
<p>Tiempo excedido</p>
</li>
<li>
<p>Parámetro erróneo</p>
</li>
</ul>
</div>
</li>
<li>
<p>Mensajes informativos</p>
<div class="ulist">
<ul>
<li>
<p>Solicitud y respuesta de eco (128 y 129)</p>
</li>
<li>
<p>Petición, informe y confirmación de oyentes <em>multicast</em> (reemplaza IGMP)</p>
</li>
<li>
<p>Solicitud y anuncio de router:</p>
<div class="ulist">
<ul>
<li>
<p>Solicitud (RS)(133): cuando un equipo está configurado para
obtener la información de direccionamiento de forma automática mediante la
configuración automática de dirección sin estado, el equipo envía un
mensaje de RS al router. El mensaje de RS se envía como un mensaje <strong>IPv6
multicast de todos los routers</strong>.</p>
</li>
<li>
<p>Anuncio (RA)(134): los routers envían mensajes de RA para proporcionar
información de direccionamiento a los equipos mediante configuración
automática de dirección sin estado.
El mensaje de RA puede incluir información de direccionamiento para el
equipo, como el prefijo y la duración de prefijo. Los routers envían
mensajes de RA <strong>de forma periódica o en respuesta a un mensaje de RS</strong>.
Los mensajes de RA se envían a la <strong>dirección IPv6 multicast de todos los
nodos</strong>. Los equipos que utilizan configuración automática de dirección sin
estado establecen su puerta de enlace predeterminada en la dirección
local al enlace del router que envió el mensaje de RA.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Solicitud y anuncio de vecino (135 y 136)</p>
</li>
<li>
<p>Redirección (137)</p>
</li>
<li>
<p>Petición y respuesta de información sobre el nodo ICMP</p>
</li>
<li>
<p>Solicitud y anuncio inversos de vecino</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_descubrimiento_de_mtu">Descubrimiento de MTU</h4>
<div class="paragraph">
<p>Una de las funcionalidades de ICMPv6 es el descubrimiento de la MTU de una
ruta, es decir, el MTU mínimo de todos los enlaces que componen la ruta. La
MTU mínima que debe soportar un enlace es 1280 bytes. En IPv4 se fragmentaban
los paquetes cuando la MTU era menor que el paquete, pero la MTU mínima era
de 64 bytes.</p>
</div>
<div class="paragraph">
<p>Para enviar paquetes de más de 1280 bytes se puede realizar
fragmentación (desaconsejado) o se puede descubrir la MTU máxima. Para descubrir
la MTU se envía un paquete y si un enlace tiene una MTU demasiado pequeña
rebotará un mensaje ICMPv6 "paquete demasiado grande". El proceso se repite
hasta que se sepa cuál es la MTU.</p>
</div>
</div>
<div class="sect3">
<h4 id="_establecimiento_de_vecindades_2">Establecimiento de vecindades</h4>
<div class="paragraph">
<p>El objetivo del establecimiento de vecindades es <strong>determinar la dirección de
enlace</strong> de un vecino del enlace, encontrar <strong>routers vecinos</strong>, detectar
<strong>direcciones duplicadas</strong> y <strong>monitorizar</strong> la alcanzabilidad del vecino.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Los paquetes ICMPv6 que tienen una cuenta de saltos inferior a 255 se ignoran.
Esto implica que sólo se procesan los paquetes pertenecientes a la misma
subred, ya que al ser encaminados se decrementa el valor. Es conveniente
para evitar ataques provenientes de otras subredes.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_autoconfiguración_sin_estados">Autoconfiguración sin estados</h5>
<div class="paragraph">
<p>El mecanismo sin estado permite que un host genere sus propias direcciones.
Para generar las direcciones, el mecanismo sin estado utiliza la información
local y la no local anunciada por los encaminadores.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Los encaminadores anuncian todos los prefijos que se han asignado al enlace
enviando un mensaje RA (134	<em>Router Advertisement</em>). Los equipos pueden
solicitar en todo momento que se genere un mensaje RA enviando un mensaje
RS (133 <em>Router Solicitation</em>).</p>
</li>
<li>
<p>Los equipos de IPv6 emplean el protocolo ND para obtener un prefijo de subred a
partir de un encaminador local.</p>
</li>
<li>
<p>Los equipos crean direcciones IPv6 automáticamente combinando el prefijo de
subred con un ID de interfaz que se genera a partir de la dirección MAC de una
interfaz (EUI-64).</p>
</li>
<li>
<p>Si no hay encaminadores, un host puede generar únicamente direcciones locales
de enlace.</p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Para configuraciones más complejas como el DNS, se requiere de
autoconfiguración con estados, es decir, DHCPv6. Para ello, los mensajes RA
incorporan un flag que anunca que existe un servidor DHCP disponible.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_solicitud_y_anuncio_de_vecinos">Solicitud y anuncio de vecinos</h5>
<div class="paragraph">
<p>El protocolo de descubrimiento de vecinos de ICMPv6 incluye dos tipos de
mensajes adicionales: mensaje de solicitud de vecino (NS) y mensaje de anuncio
de vecino (NA). Los mensajes de solicitud y de anuncio de vecino se utilizan
para lo siguiente:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Resolución de direcciones</p>
</li>
<li>
<p>Detección de direcciones duplicadas (DAD)</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_resolución_de_direcciones">Resolución de direcciones</h6>
<div class="paragraph">
<p>La resolución de direcciones se utiliza cuando un equipo en la LAN conoce
la dirección IPv6 <em>unicast</em> de un destino, pero no conoce la dirección MAC de
Ethernet. Para determinar la dirección MAC del destino, el equipo envía un
mensaje de NS a la dirección de nodo solicitado. El mensaje incluye la dirección
IPv6 conocida (objetivo). El equipo que tiene la dirección IPv6 objetivo
responde con un mensaje de NA que contiene la dirección MAC de Ethernet.</p>
</div>
</div>
<div class="sect5">
<h6 id="_detección_de_direcciones_duplicadas">Detección de direcciones duplicadas</h6>
<div class="paragraph">
<p>Cuando se asigna una dirección <em>unicast</em> global o una dirección <em>unicast</em>
local al enlace a un equipo, se recomienda llevar a cabo la detección de
direcciones duplicadas (DAD) en la dirección para asegurarse de que sea única.
Para revisar si una dirección es única, el equipo envía un mensaje de NS
con su propia dirección IPv6 como la dirección IPv6 objetivo. Si otro
equipo en la red tiene esta dirección, responde con un mensaje de NA.
Este mensaje de NA notifica al equipo emisor que la dirección está en uso.
Si no se devuelve un mensaje de NA correspondiente dentro de determinado
período, la dirección <em>unicast</em> es única y su uso es aceptable.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_solicitud_y_anuncio_de_vecinos_2">Solicitud y anuncio de vecinos</h5>
<div class="paragraph">
<p>Los nodos generan este paquete para informar a los enrutadores de que existe
una ruta mejor para llegar a un determinado destino. El tipo de paquete es 137.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ventajas_de_icmpv6">Ventajas de ICMPv6</h4>
<div class="paragraph">
<p>Cuando se anuncia el router (mensaje RA) el propio mensaje contiene la dirección
IP del router, por lo que no hace falta configurarlo en el equipo final
como puerta de enlace. El mensaje también lleva la MAC del router, por lo que
también se ahorra ejecutar el ciclo ARP. Otro dato que viene en el mensaje es
la máscara, por lo que es otro parámetro que no necesitamos configurar
manualmente.</p>
</div>
<div class="paragraph">
<p>Otras ventajas son:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Se puede renumerar todo sin tener que reconfigurar los equipos finales,</p>
</li>
<li>
<p>Autoconfiguración sin estados</p>
</li>
<li>
<p>Descubrir MTU</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_descubrimiento_de_destinos_em_multicast_em_mld">Descubrimiento de destinos <em>multicast</em> (MLD)</h4>
<div class="paragraph">
<p>MLD es equivalente a IGMP para IPv4. Existe MLDv1 y MLDv2 para la gestión de
grupos <em>multicast</em>.</p>
</div>
<div class="sect4">
<h5 id="_mldv1">MLDv1</h5>
<div class="paragraph">
<p>Se pueden encontrar los siguientes mensajes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Query</code>:</p>
<div class="ulist">
<ul>
<li>
<p><code>General Query</code>: Pregunta a los terminales las direcciones multicast
que atienden.</p>
</li>
<li>
<p><code>Address Specific Query</code>: Pregunta qué terminales atienden <strong>una dirección
multicast específica</strong>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>Report</code>: El terminal indica la lista o dirección que atiende.</p>
</li>
<li>
<p><code>Done</code>: El terminal indica que deja de antender una dirección.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dhcpv6">DHCPv6</h3>
<div class="paragraph">
<p>Las mejoras de DHCPv6 frente a la versión anterior son:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Nuevo direccionamiento.</p>
</li>
<li>
<p>Más potente que la autoconfiguración sin estados.</p>
</li>
<li>
<p>Puede usarse en entornos sin router.</p>
</li>
<li>
<p>Permite renumeración.</p>
</li>
<li>
<p>Permite registro automático DDNS.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>El funcionamiento es el mismo que en IPv4 pero con la diferencia de que si no
encuentra routers que soporten DHCP en la subred mediante anuncios RA se envía
una petición DHCP a la dirección multicast de todos los servidores y repetidores
DHCP <strong>usando la dirección local al enlace como origen.</strong></p>
</div>
</div>
<div class="sect2">
<h3 id="_encaminamiento">Encaminamiento</h3>
<div class="paragraph">
<p>Se busca la mejor ruta igual que en IPv4, seleccionando el prefijo coincidente
más largo. En lugar de RIP se usa RIPng que incluye algunas mejoras y para
actualizaciones se usa la dirección <code>FF02::9</code>.
También existe una versión de OSPF para IPv6 (OSPFv3). Algunos añadidos son las
direcciones IP de <strong>todos los routers OSPF</strong> (<code>FF02::5</code>) y <strong>todos los routers
OSPF designados</strong> (<code>FF02::6</code>).</p>
</div>
</div>
<div class="sect2">
<h3 id="_soporte_sobre_protocolos_de_enlace">Soporte sobre protocolos de enlace</h3>
<div class="paragraph">
<p>IPv6 sobre Ethernet define el formato de trama y datagrama, la formación de
direcciones autoconfiguradas y locales al enlace y soporta todas las variantes
(incluida VLAN). MTU en RA superiores a 1500 se ignoran.</p>
</div>
<div class="paragraph">
<p>En IPv6 sobre PPP el identificador de protocolo de PPP es <code>0x0057</code>. Para la
asignación de direcciones se usa ICMPv6 en lugar de LCP.</p>
</div>
</div>
<div class="sect2">
<h3 id="_dns">DNS</h3>
<div class="paragraph">
<p>Se añaden los registros <code>AAAA</code> para búsquedas directas y <code>PTR</code> para búsquedas
inversas.</p>
</div>
</div>
<div class="sect2">
<h3 id="_migración">Migración</h3>
<div class="paragraph">
<p>Dado que IPv6 debe coexistir con IPv4 existen una serie de alternativas que
permiten funcionar juntos.</p>
</div>
<div class="sect3">
<h4 id="_pilas_duales">Pilas duales</h4>
<div class="paragraph">
<p>Se usan ambos protocolos simultáneamente. Cada aplicación decide qué versión
IP utilizar dependiendo de cómo sea la respuesta del DNS si hace la petición o
en función de la IP origin cuando responde a una paquete. Los routers activan
las pilas según se configuren. Este método permite coexistencia y actualización
gradual.</p>
</div>
</div>
<div class="sect3">
<h4 id="_tunelado">Tunelado</h4>
<div class="paragraph">
<p>Se trata de encapsular el paquete IPv6 dentro de paquetes IPv4 con o sin
cabecera GRE. Se puede realizar de diferentes formas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Tunelado manual</strong>: La configuración de los extremos del tunel es manual.
Existe una correspondencia de direcciones IPv6 &lt;&gt; IPv4. <strong>No es escalable</strong>.</p>
</li>
<li>
<p><strong>Tunelado automático</strong>:</p>
<div class="ulist">
<ul>
<li>
<p><strong>6to4</strong>: Existe una correspondencia automática, para ello se asigna un
prefijo a la red IPv6. Toda la red comparte el prefijo <strong>6to4</strong>. Es sencill y
flexible.</p>
</li>
<li>
<p><strong>Intra-Site Automatic Tunnel Addressing Protocol</strong> (ISATAP): Permite migrar
a IPv6 los sistemas finales de una red privada sin routers IPv6. La conexión
al exterior requiere routers que actúen como pasarela. Se usa EUI-64 para
encapsular la dirección IPv4: <code>XXXX:XXXX:XXXX:XXXX:0000:5EFE:a.b.c.d</code>.</p>
</li>
<li>
<p><strong>Teredo</strong>: El único de los métodos que es compatible con NAT. La idea es
encapsular IPv6 en UDP sobre IPv4 para poder sortear el NAT. Se envía un
paquete de sondeo para ver si un equipo Teredo responde tras el NAT.</p>
<div class="listingblock text-center">
<div class="content">
<pre>+----------------+-----------------+---------+-----------+-----------+
| Prefijo Teredo | Servidor Teredo | Tipo de |  Puerto   | Dirección |
|   2001:0000    | Dirección IPv4  |   NAT   |  Global   | Global    |
+----------------+-----------------+---------+-----------+-----------+</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</body>
</html>